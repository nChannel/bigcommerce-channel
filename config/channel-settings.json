{
  "name": "Bigcommerce",
  "description": "Bigcommerce Registry",
  "channelIcon": "",
  "definitionFolderName": " ",
  "retailClasses": [
    "eCommerce"
  ],
  "orderProcessingRoles": [
  	"Sales"
  ],
  "channelActionRegistries": [
    {
      "name": "GET SALESORDER",
      "description": "GET SALESORDER",
      "channelVerb": "GET",
      "channelNoun": "SALESORDER",
      "ruleDef": {
        "ruleSchema": {},
        "defaultRuleValues": {}
      },
      "configDef": {
        "configModel": {
          "required": [
            "orderStatus"
          ],
          "properties": {
            "orderStatus": {
              "type": "string",
              "title": "Get Orders With Status"
            }
          }
        },
        "configView": [
          "orderStatus"
        ],
        "configValues": {
          "orderStatus": "open"
        }
      },
      "documentDef": {
        "schema": {},
        "referenceLocation": {"salesOrderBusinessReferences": ["order.id"]},
        "remoteID": "id",
        "peers": [
          {
            "name": "PRODUCT",
            "location": "order.products",
            "remoteID": "id",
            "businessReferences": ["name"]
          }
        ]
      }
    },
    {
      "name": "PUT FULFILLMENT",
      "description": "PUT FULFILLMENT",
      "channelVerb": "PUT",
      "channelNoun": "FULFILLMENT",
      "ruleDef": {
        "ruleSchema": {},
        "defaultRuleValues": {}
      },
      "configDef": {
        "configValues" : {
          "canUpdateFulfillmentFlag" : true
        },
        "configView" : [
          "canUpdateFulfillmentFlag"
        ],
        "configModel" : {
          "required": [
            "canUpdateFulfillmentFlag"
          ],
          "properties": {
            "canUpdateFulfillmentFlag": {
              "type": "boolean",
              "title": "PUT Fulfillment, canUpdateFulfillmentFlag"
            }
          },
          "type": "object"
        }
      },
      "documentDef": {
        "schema": {},
        "referenceLocation": {
          "fulfillmentBusinessReferences": ["fulfillment.id"],
          "salesOrderBusinessReferences": ["fulfillment.order_id"]
        },
        "remoteID": "fulfillment.id"
      }
    }
  ],
  "channelSettingsSchema": {
    "configDef": {
      "configModel": {
        "type": "object",
        "title": "Bigcommerce Channel Settings",
        "properties": {
          "api_uri": {
            "title": "API URI",
            "type": "string"
          },
          "implFolderName": {
            "title": "Implementation Folder Name",
            "type": "string"
          }
        },
        "required": [
          "api_uri",
          "implFolderName"
        ]
      },
      "configView": [],
      "configValues": {
        "api_uri": "https://api.bigcommerce.com",
        "implFolderName": "@nchannel/bigcommerce"
      }
    }
  },
  "channelAuthSchema": {
    "authType": "oauth",
    "configDef": {
      "configModel": {
        "type": "object",
        "title": "oAuth Config",
        "properties": {
          "store_hash": {
            "title": "Store Hash",
            "type": "string",
            "pattern": "^store-[\\w.+\\-]+\\.mybigcommerce\\.com$",
            "validationMessage": "Must be a valid Bigcommerce Store URL"
          },
          "access_token":{
            "type": "string"
          }
        },
        "required": [
          "store_hash",
          "access_token"
        ]
      },
      "configView": [
        {
          "key": "store_hash",
          "title": "Store Hash",
          "placeholder":"store-<store-hash>.mybigcommerce.com",
          "isMainField": true
        }
      ],
      "configValues": {}
    },
    "oauthAuthorizeUrl": "https://login.bigcommerce.com/oauth2/authorize?client_id={{client_id}}&context=stores%2F{{store_hash}}&redirect_uri=https://localhost/account/v1/applications/getAccessToken&state={{state}}&response_type=code&scope=store_cart_read_only+store_themes_read_only+store_v2_content_read_only+store_v2_customers+store_v2_default+store_v2_information_read_only+store_v2_marketing_read_only+store_v2_orders+store_v2_products+store_v2_transactions",
    "oauthTokenRequest": {
      "verb": "POST",
      "url": "https://login.bigcommerce.com/oauth2/token",
      "headers": {
        "Content-Type": "application/json"
      },
      "body": {
        "client_id": "{{client_id}}",
        "client_secret": "{{client_secret}}",
        "code": "{{code}}",
        "context": "stores/{{store_hash}}",
        "scope": "{{scope}}",
        "grant_type": "authorization_code",
        "redirect_uri": "https://localhost/account/v1/applications/getAccessToken"
      }
    },
    "oauthTokenResponse": {
      "access_token": "access_token",
      "scope": "scope"
    },
    "apps": [
      {
        "applicationRegistryID": "100000000000000000000003",
        "appName": "automation-manager"
      }
    ],
    "oauthUserRequest": {
      "verb": "GET",
      "url": "https://api.bigcommerce.com/stores/{{store_hash}}/v2/store",
      "headers": {
        "Content-Type": "application/json",
        "X-Auth-Token": "{{access_token}}",
        "X-Auth-Client": "{{client_id}}"
      }
    },
    "oauthUserResponse": {
      "user": {
        "firstName": "first_name",
        "emailAddress": "admin_email"
      },
      "account": {
        "company": "name"
      }
    },
    "oauthIdentifier": "{{store_hash}}",
    "oauthRequestVerification": {
      "algorithm": "sha256",
      "key": "client_secret",
      "digest": "hmac",
      "encoding": "hex",
      "parameters": [
        {"index": 0, "key": "code", "ref": "code"},
        {"index": 1, "key": "store_hash", "ref": "store_hash"},
        {"index": 2, "key": "state", "ref": "state"},
        {"index": 3, "key": "timestamp", "ref": "timestamp"}
      ]
    }
  }
}
